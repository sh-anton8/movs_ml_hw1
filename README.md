# Отчет о проделанной работе

В данном проекте стояла задача предсказания цены автомобиля по некоторым его характеристикам. Необходимо воспользоваться моделью линейной регрессии, тк заказчик требует интерпретируемость и простоту от модели. 

На первом этапе я ознакомился с данными, конвертировал некоторые признаки в подходящий формат и визуализировал некоторые зависимости. Благодаря этому удалось выяснить, что при разделении на обучающую и отложенную выборки совокупности оказались похожими. Кроме того, между признаками max_power & engine наблюдается довольно сильная положительная линейная зависимость, а с целевой переменной есть явная связь у характеристик max_power, engine и year. 

После небольшой обработки данных, были обучены модели бэйзлайна: 1) модель на вещественных признаках (с подобранным коэффициентом регуляризации, лассо регрессия) и модель на всех признаках (также с подобранным коэффициентом регуляризации, гребневая регрессия). Они выбивали следующее качество:

|    Модель          |     MSE      |   R2   |
| ------------------ |:------------:|:------:|
| Num features TRAIN | 117090306033 | 0.5915 |
| All features TRAIN |  99401395793 | 0.6532 |
| Num features TEST  | 233551443099 | 0.5937 |
| All features TEST  | 203950140255 | 0.6451 |

Когда качество бейзлайн моделей было зафиксировано, я приступил к экспериментам по учучшению качества. В выборе моделей мы ограничены (только линейные), так что основной инструмент - Feature Engineering. Были проделаны следующие шаги: 
1. Разделение признака torque на два : max_torque_rpm и torque_only
2. Извлечение марки автомобиля из названия (извлекаем первое слово, приводим к нижнему регистру)
3. Dummy признаки для nan значений (если в каком-то показателе встречался nan - заменяем его на медианное значение, посчитанное по обучающей выборке и добавляем соответствующий dummy признак)
4. Категоризируем признак year (у таргета есть зависимость от этого признака, значит его нужно использовать на максимум. Бьем временной промежуток на десятилетия и добавляем dummy признаки каждого десятилетия)
5. Извлечение выбрасов из тренировочной выборки
6. Добавляем логарифмы численных показателей
7. Логарифмируем таргет

Пункты 1 и 2 привели к приросту качества до 0.7449 (R2) на отложенной выборке. Пункты 3, 4 и 5 оказались не столь значимыми, однако после них качество возросло до 0.7678 (R2, TEST). Самыми значимыми оказались пункты 6 и 7, разберем их подробнее. 



![Screenshot](photo_proof/App_launch.png)
